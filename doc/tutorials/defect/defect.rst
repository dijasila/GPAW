.. _defect:

===========================
Defect scattering potential
===========================

This module allows to model the impact of defects on the electron dynamics
(e.g., quasiparticle and carrier scattering which affect, respectively, the
spectral function and transport) in disordered materials with the `T`-matrix
formalism [#Tmatrix1]_.

The main ingredient in this approach is the single-defect potential defined by
the difference in the DFT potential between a system with a defect of type
`\alpha` and the pristine system, i.e.

.. math::

    \hat{V}_\alpha = V_\mathrm{def}(\hat{\mathbf{r}})
                - V_\mathrm{pris}(\hat{\mathbf{r}}) .

In practice, the potentials are obtained from calculations on supercells
generated by repeating the system `N_i` times in the direction of the `i`th
primitive lattice vector `\mathbf{a}_i`. Due to periodic boundary conditions on
the boundaries in the repeated directions, the supercell must be large enough
that neighboring supercells don't interact.

Once the defect potential has been obtained, its matrix elements with respect to
the unperturbed Bloch states can be calculated,

.. math::

    V_{\mathbf{k}\mathbf{k'}}^{nn'}=
    \langle\psi_{n\mathbf{k}}| \hat{V} |\psi_{n'\mathbf{k}'}\rangle .

Here, `n` is the band index (including spin) and `\mathbf{k}\elem 1. ` BZ is the
electronic wave vector.

Finally, the `T` matrix defined by the integral equation

.. math::

    \hat{T}(\varepsilon) = \hat{V} + \hat{V} \hat{G}^0(\varepsilon) \hat{T}(\varepsilon),
    
can be calculated. Here, `G^0(\varepsilon)=(\varepsilon - \hat{H}_0)^{-1}` is
the bare Green's function given by the resolvent of the unperturbed Hamiltonian.

The `T` matrix is a useful quantity in many aspects of modelling the electronic
properties of 1) single defect sites (e.g., local density of states), and 2)
disorder systems, i.e. system with a random configuration of defects [#Tmatrix1]_[#Tmatrix2]_.

The [#Tmatrix1]_[#Tmatrix2]_ script ``defect_run.py`` takes the gpw files of the defective and
pristine calculation as input, as well as the gaussian parameters and
dielectric constant, and calculates the different terms in the correction
scheme. For this case, the calculated value of `E_{\mathrm{l}}` is -1.28 eV.

.. literalinclude:: defect_run.py

.. math::

    s_{mk}\equiv\langle mk|\sigma_z|mk\rangle

and is useful for analyzing the degree of spin-orbit induced hybridization
between spin up and spin down states. Examples of this will be given below.
The implementation is documented in Ref. [#Tmatrix1]_


Band structure of bulk Pt
=========================

every second spin-orbit band, since time-reversal symmetry along with
inversion symmetry dictates that all bands are two-fold degenerate (you can
check this for the present case). The plot is shown below.

.. image:: Pt_bands.png
           :height: 500 px

An important property of the spin-orbit interaction is the fact that it can
lift degeneracies between states that are protected by symmetry when spin-
orbit coupling is absent. This is well-known for the hydrogen atom where the

where `\xi_m` are the parity eigenvalues of Kramers pairs of occupied bands at
the parity invariant points `\Lambda_a`.

but in the present case only 4 are inequivalent. These are calcaluted with
the script :download:`defect_run.py` and the parity eigenvalues are
obtained with :download:`defect_run.py`. Note that the product of parity
eigenvalues at `\Gamma` changes from -1 to 1 when spin-orbit coupling is added
and the `\nu` thus changes from 0 to 1.


.. _magnetic anisotropy:

Magnetic anisotropy of hcp Co
=============================

As a final application of the spinorbit module we will calculate the magnetic
anisotropy of hcp Co. The idea is that the direction of spin polarization


.. [#Tmatrix1] K. Kaasbjerg, J. H. J. Martine, T. Low and A.-P. Jauho
           *Phys. Rev. B* **96**, 241411(R) (2017)
.. [#Tmatrix2] K. Kaasbjerg,
           *Phys. Rev. B* **XX**, XXXXXX (2019)
.. [#Tmatrix3] K. Kaasbjerg and A.-P. Jauho
           *Phys. Rev. X* **XX**, XXXXXX (2019)
